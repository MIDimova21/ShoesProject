{% extends "base.html" %}

{% block link %}
        <link rel="stylesheet" href="{{ url_for('static', filename='base.css') }}">
        <link rel="stylesheet" href="{{ url_for('static', filename='catalog.css') }}">
{% endblock %}

{% block content %}
<div class="catalog-container">
  <div class="filter-box">
    <form method="get" action="{{ url_for('catalog.show_catalog') }}">
      <div class="filter-row">

        <select name="category" class="filter-select">
          <option value="all">–ö–∞—Ç–µ–≥–æ—Ä–∏–∏</option>
          {% for cat in categories %}
            <option value="{{ cat }}" {% if selected_category == cat %}selected{% endif %}>{{ cat }}</option>
          {% endfor %}
        </select>

        <select name="available_size" class="filter-select">
          <option value="">–†–∞–∑–º–µ—Ä–∏</option>
          <option value="36">36</option>
          <option value="37">37</option>
          <option value="38">38</option>
          <option value="39">39</option>
          <option value="40">40</option>
          <option value="41">41</option>
          <option value="42">42</option>
          <option value="43">43</option>
        </select>
      </div>

      <div class="filter-row">
        <input type="number" name="max_price" placeholder="–¶–µ–Ω–∞" value="{{ —Ü–µ–Ω–∞ or '' }}" class="filter-input price-input">
        <label>
          <input class="checkbox" type="checkbox" name="in_stock" {% if in_stock %}checked{% endif %}>–°–∞–º–æ –Ω–∞–ª–∏—á–Ω–∏
        </label>
        <button type="submit" class="btn-filter">–§–∏–ª—Ç—Ä–∏—Ä–∞–π</button>
      </div>
    </form>
  </div>


  <div class="products-grid">
    {% for product in products %}
      <div class="product-card-modern">
        <div class="product-image">
          <img src="{{ product.image_url }}" alt="photo">
        </div>

        <div class="product-info">
          <h3 class="product-title">{{ product.name }}</h3>
          <p class="product-category">{{ product.category }}</p>
          <div class="product-details">
            <span class="detail-badge">üé® {{ product.color }}</span>
            <span class="detail-badge">üìè {{ product.sizes }}</span>
            <span class="detail-badge">üì¶ Stock: {{ product.stock }}</span>
          </div>
          <p class="product-price-modern">{{ product.price }}–ª–≤</p>

          {% if session.logged_in %}
            <form method="POST" action="{{ url_for('cart.add_to_cart', product_id=product.product_id) }}" class="add-to-cart-form">
              <select name="size" required class="size-dropdown">
                <option value="">–ò–∑–±–µ—Ä–∏ —Ä–∞–∑–º–µ—Ä</option>
                {% for size in product.sizes.split(",") %}
                  <option value="{{ size }}">–†–∞–∑–º–µ—Ä {{ size.strip() }}</option>
                {% endfor %}
              </select>
              <button type="submit" class="btn-add-modern">–î–æ–±–∞–≤–∏ –∫—ä–º –∫–æ–ª–∏—á–∫–∞—Ç–∞</button>
            </form>
          {% else %}
            <a href="{{ url_for('auth.login') }}" class="btn-login-modern">–†–µ–≥–∏—Å—Ç—Ä–∏—Ä–∞–π —Å–µ –∑–∞ –¥–∞ –ø–∞–∑–∞—Ä—É–≤–∞—à</a>
          {% endif %}
        </div>
      </div>
    {% endfor %}
  </div>
</div>
{% endblock %}
