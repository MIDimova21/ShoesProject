{% extends "base.html" %}

{% block link %}
<link rel="stylesheet" href="{{ url_for('static', filename='base.css') }}">
<link rel="stylesheet" href="{{ url_for('static', filename='cart.css') }}">
{% endblock %}

{% block content %}
<div class="cart-page-container">
  <div class="cart-content">
    <div class="cart-left">
      <div class="cart-header">
        <h2>–ö–æ—à–Ω–∏—Ü–∞ ({{ cart_items|length }})</h2>
      </div>

      {% if cart_items %}

        <div class="cart-items-list">
          {% for item in cart_items %}
            <div class="cart-item-card">
              <div class="item-image">
                <img src="{{ item.product.image_url }}" alt="{{ item.product.name }}">
              </div>

              <div class="item-details">
                <h3 class="item-name">{{ item.product.name }}</h3>
                <p class="item-subtitle">{{ item.product.category }} {{ item.product.name }} {{ item.product.color }}</p>

                <div class="item-specs">
                  <span class="spec-item">–¶–≤—è—Ç: {{ item.product.color }}</span>
                  <span class="spec-item">–†–∞–∑–º–µ—Ä: {{ item.size }}</span>
                  <span class="spec-item">–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ: {{ item.quantity }}</span>
                </div>

                <div class="item-actions">
                  <button type="submit" class="action-btn">–ü—Ä–µ–º–∞—Ö–Ω–∏</button>
                </div>


              </div>

              <div class="item-pricing">
                <p class="item-price">{{ item.product.price * item.quantity }} –ª–≤</p>
              </div>
            </div>
          {% endfor %}
        </div>

      {% else %}
        <div class="empty-cart">
          <p>–ö–æ–ª–∏—á–∫–∞—Ç–∞ –≤–∏ –µ –ø—Ä–∞–∑–Ω–∞ üõí</p>
        </div>
      {% endif %}
    </div>

    {% if cart_items %}
      <div class="cart-right">
        <div class="summary-card">
          <h3>–û–±–æ–±—â–µ–Ω–∏–µ</h3>

          <div class="summary-row">
            <span>–°—Ç–æ–π–Ω–æ—Å—Ç –Ω–∞ –ø—Ä–æ–¥—É–∫—Ç–∏—Ç–µ:</span>
            {% set total_price = namespace(value=0) %}
            {% for item in cart_items %}
              {% set total_price.value = total_price.value + (item.product.price * item.quantity) %}
            {% endfor %}
            <span class="summary-value">{{ total_price.value }} –ª–≤</span>
          </div>

          <div class="summary-row">
            <span>–î–æ—Å—Ç–∞–≤–∫–∞:</span>
            <span class="summary-value">–ò–∑–±–µ—Ä–µ—Ç–µ –¥–æ—Å—Ç–∞–≤–∫–∞ –∏ –ø–ª–∞—â–∞–Ω–µ</span>
          </div>

          <div class="discount-code">
            <button class="discount-toggle">+ –ö–æ–¥ –∑–∞ –æ—Ç—Å—Ç—ä–ø–∫–∞</button>
          </div>

          <div class="summary-total">
            <span>–û–±—â–∞ –¥—ä–ª–∂–∏–º–∞ —Å—Ç–æ–π–Ω–æ—Å—Ç:</span>
            <span class="total-price">{{ total_price.value }} –ª–≤</span>
          </div>

          <a href="{{ url_for('cart.checkout') }}" class="checkout-btn">–ü–õ–ê–©–ê–ù–ï</a>

          <a href="{{ url_for('cart.export_cart_pdf') }}" class="pdf-btn">üìÑ –ò–∑—Ç–µ–≥–ª–µ—Ç–µ PDF</a>
        </div>
      </div>
    {% endif %}
  </div>
</div>
{% endblock %}